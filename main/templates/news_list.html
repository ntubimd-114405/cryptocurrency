{% extends 'base.html' %}

{% block title %}æ‰€æœ‰æ–°è{% endblock %}

{% block content %}
    <div class="container mt-4">
        <h1 class="text-center mb-4">æ‰€æœ‰æ–°è</h1>
        <!-- ä½¿ç”¨ d-flex å’Œ justify-content-center ä¾†æ°´å¹³å±…ä¸­ -->
        <form method="GET" action="." class="d-flex justify-content-center align-items-center" style = "margin-left: 40%; margin-bottom: 10px;">
            <div class="row w-100">
                <!-- å·¦å´ï¼šé—œéµå­—æœå°‹å’Œæ—¥æœŸç¯©é¸ -->
                <div class="col-md-4">
                    <div class="form-group">
                        <label for="q">æœå°‹æ–°è</label>
                        <input type="text" name="q" id="q" class="form-control" placeholder="Search news..." value="{{ query }}">
                    </div>

                    <div class="form-group">
                        <label for="start_date">é–‹å§‹æ—¥æœŸ</label>
                        <input type="date" name="start_date" id="start_date" class="form-control" value="{{ request.GET.start_date }}">
                    </div>

                    <div class="form-group">
                        <label for="end_date">çµæŸæ—¥æœŸ</label>
                        <input type="date" name="end_date" id="end_date" class="form-control" value="{{ request.GET.end_date }}">
                    </div>
                </div>

                <!-- å³å´ï¼šæäº¤æŒ‰éˆ• -->
                <div class="col-md-1 d-flex align-items-end">
                    <button type="submit" class="btn btn-primary" style = "margin-bottom: 160%;">Search</button>
                </div>
            </div>
        </form>

        {% if error %}
            <div class="alert alert-danger" role="alert">
                {{ error }}
            </div>
        {% else %}
            <!-- æ–‡ç« åˆ—è¡¨ -->
            <table class="table table-bordered table-striped table-hover">
                <thead class="table-dark">
                    <tr>
                        <th style="width: 50px; text-align: center;">æ¨™é¡Œ</th>
                        <th style="width: 50px; text-align: center;">åœ–ç‰‡</th>
                        <th style="width: 50px; text-align: center;">ä¾†æºç¶²ç«™</th>
                        <th style="width: 50px; text-align: center;">ç¶²å€</th>
                        <th style="width: 50px; text-align: center;">æ™‚é–“</th>
                        <th style="width: 50px; text-align: center;">è©•è«–</th>
                        <th style="width: 50px; text-align: center;">æƒ…ç·’</th>
                    </tr>
                </thead>
                <tbody>
                    {% for article in all_articles %}
                        <tr>
                            <td><a href="{{ article.url }}" target="_blank">{{ article.title }}</a></td>
                            <!-- é¡¯ç¤ºåœ–ç‰‡ -->
                            <td style="text-align: center;">
                                {% if article.image_url %}
                                    <img src="{{ article.image_url }}" alt="æ–°èåœ–ç‰‡" style="max-width: 1000px; max-height: 1000px;">
                                {% else %}
                                    ç„¡åœ–ç‰‡
                                {% endif %}
                            </td>
                            <td><a href="{{ article.website.name }}" target="_blank"><img src="{{ article.website.icon_url }}" alt="ç¶²ç«™åœ–ç‰‡" style="max-width: 220px;max-height: 100px;"></a></td>
                            <td><a href="{{ article.url }}" target="_blank">é–±è®€æ›´å¤š</a></td>
                            <td>{{ article.time|date:"Y-m-d" }}</td>
                            <td><a href="{% url 'news_detail' article_id=article.id %}">è©•è«–</a></td>
                            <td>
                                {% if article.sentiment == 'positive' %}
                                    ğŸ˜„
                                {% elif article.sentiment == 'neutral' %}
                                    ğŸ˜
                                {% elif article.sentiment == 'negative' %}
                                    ğŸ˜”
                                {% else %}
                                    â“
                                {% endif %}
                            </td>
                        </tr>
                    {% empty %}
                        <tr>
                            <td colspan="5" class="text-center">æ²’æœ‰æ‰¾åˆ°æ–°è</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}

    </div>
{% endblock %}
